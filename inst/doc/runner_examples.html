<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Runner examples</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Runner examples</h1>



<p>The most fundamental function in <code>runner</code> package is <code>runner</code>. With <code>runner::runner</code> one can apply any R function on running windows. This tutorial presents set of examples explaining how to tackle some tasks. Some of the examples are referenced to original topic on <a href="https://stackoverflow.com">stack-overflow</a>.</p>
<div id="number-of-unique-elements-in-7-days-window" class="section level3">
<h3>Number of unique elements in 7 days window</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">sample</span>(letters, <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">date &lt;-<span class="st"> </span><span class="kw">Sys.Date</span>() <span class="op">+</span><span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="co"># unequaly spaced time series</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">runner</span>(</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  x, </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">k =</span> <span class="st">&quot;7 days&quot;</span>, </a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">idx =</span> date, </a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="dt">f =</span> <span class="cf">function</span>(x) <span class="kw">length</span>(<span class="kw">unique</span>(x))</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">)</a></code></pre></div>
<pre><code>##  [1] 1 1 2 3 2 2 3 2 2 2 2 2 3 2 1 2 3 3 4 4</code></pre>
</div>
<div id="weekly-trimmed-mean" class="section level3">
<h3>weekly trimmed mean</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">date &lt;-<span class="st"> </span><span class="kw">Sys.Date</span>() <span class="op">+</span><span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="co"># unequaly spaced time series</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">runner</span>(</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  x, </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">k =</span> <span class="st">&quot;week&quot;</span>, </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="dt">idx =</span> date, </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="dt">f =</span> <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">trim =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">)</a></code></pre></div>
<pre><code>##  [1] -0.45570427  0.05141348  0.49139631  1.36488554  1.95825964  1.39570190
##  [7]  1.13721199  0.55797114  0.49053289  0.40135966 -0.02990304 -1.12243140
## [13] -1.69157529 -1.76535337 -2.32295965 -1.98330961 -2.12996001 -2.28638815
## [19] -3.28535707 -2.97083821</code></pre>
</div>
<div id="prediction-on-current-day-based-on-preceding-2-weeks-regression" class="section level3">
<h3>Prediction on current day based on preceding 2-weeks regression</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">date &lt;-<span class="st"> </span><span class="kw">Sys.Date</span>() <span class="op">+</span><span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="co"># unequaly spaced time series</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(date, y, x)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">data<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">runner</span>(</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  data,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  <span class="dt">lag =</span> <span class="st">&quot;1 day&quot;</span>,</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  <span class="dt">k =</span> <span class="st">&quot;2 weeks&quot;</span>,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  <span class="dt">idx =</span> data<span class="op">$</span>date,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">  <span class="dt">f =</span> <span class="cf">function</span>(data) {</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">      <span class="kw">predict</span>(</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">        <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">      )[<span class="kw">nrow</span>(data)]</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="kw">plot</span>(data<span class="op">$</span>date, data<span class="op">$</span>y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="kw">lines</span>(data<span class="op">$</span>date, data<span class="op">$</span>pred, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rolling-sums-for-groups-with-uneven-time-gaps" class="section level3">
<h3>Rolling sums for groups with uneven time gaps</h3>
<p><a href="https://stackoverflow.com/a/58167952/3495076">SO discussion</a></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">3737</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">user_id =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">27</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="dv">11</span>, <span class="dv">7</span>)),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="dt">date =</span> <span class="kw">as.Date</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">'2016-01-01'</span>, <span class="st">'2016-01-03'</span>, <span class="st">'2016-01-05'</span>, <span class="st">'2016-01-07'</span>, </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                       <span class="st">'2016-01-10'</span>, <span class="st">'2016-01-14'</span>, <span class="st">'2016-01-16'</span>), <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">value =</span> <span class="kw">round</span>(<span class="kw">rnorm</span>(<span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">5</span>), <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span><span class="kw">group_by</span>(user_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">    <span class="dt">v_minus7  =</span> <span class="kw">sum_run</span>(value, <span class="dv">7</span>, <span class="dt">idx =</span> date),</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">    <span class="dt">v_minus14 =</span> <span class="kw">sum_run</span>(value, <span class="dv">14</span>, <span class="dt">idx =</span> date)</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  )</a></code></pre></div>
<pre><code>## # A tibble: 14 x 5
## # Groups:   user_id [2]
##    user_id date       value v_minus7 v_minus14
##      &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1      27 2016-01-01  15       15        15  
##  2      27 2016-01-03  22.4     37.4      37.4
##  3      27 2016-01-05  13.3     50.7      50.7
##  4      27 2016-01-07  21.9     72.6      72.6
##  5      27 2016-01-10  20.6     55.8      93.2
##  6      27 2016-01-14  18.6     39.2     112. 
##  7      27 2016-01-16  16.4     55.6     113. 
##  8      11 2016-01-01   6.8      6.8       6.8
##  9      11 2016-01-03  21.3     28.1      28.1
## 10      11 2016-01-05  19.8     47.9      47.9
## 11      11 2016-01-07  22       69.9      69.9
## 12      11 2016-01-10  19.4     61.2      89.3
## 13      11 2016-01-14  17.5     36.9     107. 
## 14      11 2016-01-16  19.3     56.2     119.</code></pre>
</div>
<div id="unique-for-specified-time-frame" class="section level3">
<h3>Unique for specified time frame</h3>
<p><a href="https://stackoverflow.com/questions/41693081/">SO discussion</a></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">text =</span> <span class="st">&quot;  user_id       date category</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">       27 2016-01-01    apple</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">       27 2016-01-03    apple</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="st">       27 2016-01-05     pear</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">       27 2016-01-07     plum</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">       27 2016-01-10    apple</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">       27 2016-01-14     pear</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">       27 2016-01-16     plum</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">       11 2016-01-01    apple</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">       11 2016-01-03     pear</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="st">       11 2016-01-05     pear</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="st">       11 2016-01-07     pear</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="st">       11 2016-01-10    apple</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="st">       11 2016-01-14    apple</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">       11 2016-01-16    apple&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-19" data-line-number="19"></a>
<a class="sourceLine" id="cb8-20" data-line-number="20">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="st">  </span><span class="kw">group_by</span>(user_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">    <span class="dt">distinct_7  =</span> <span class="kw">runner</span>(category, </a>
<a class="sourceLine" id="cb8-24" data-line-number="24">                         <span class="dt">k =</span> <span class="st">&quot;7 days&quot;</span>, </a>
<a class="sourceLine" id="cb8-25" data-line-number="25">                         <span class="dt">idx =</span> <span class="kw">as.Date</span>(date), </a>
<a class="sourceLine" id="cb8-26" data-line-number="26">                         <span class="dt">f =</span> <span class="cf">function</span>(x) <span class="kw">length</span>(<span class="kw">unique</span>(x))),</a>
<a class="sourceLine" id="cb8-27" data-line-number="27">    <span class="dt">distinct_14 =</span> <span class="kw">runner</span>(category, </a>
<a class="sourceLine" id="cb8-28" data-line-number="28">                         <span class="dt">k =</span> <span class="st">&quot;14 days&quot;</span>, </a>
<a class="sourceLine" id="cb8-29" data-line-number="29">                         <span class="dt">idx =</span> <span class="kw">as.Date</span>(date), </a>
<a class="sourceLine" id="cb8-30" data-line-number="30">                         <span class="dt">f =</span> <span class="cf">function</span>(x) <span class="kw">length</span>(<span class="kw">unique</span>(x)))</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">  )</a></code></pre></div>
<pre><code>## # A tibble: 14 x 5
## # Groups:   user_id [2]
##    user_id date       category distinct_7 distinct_14
##      &lt;int&gt; &lt;fct&gt;      &lt;fct&gt;         &lt;int&gt;       &lt;int&gt;
##  1      27 2016-01-01 apple             1           1
##  2      27 2016-01-03 apple             1           1
##  3      27 2016-01-05 pear              2           2
##  4      27 2016-01-07 plum              3           3
##  5      27 2016-01-10 apple             3           3
##  6      27 2016-01-14 pear              2           3
##  7      27 2016-01-16 plum              3           3
##  8      11 2016-01-01 apple             1           1
##  9      11 2016-01-03 pear              2           2
## 10      11 2016-01-05 pear              2           2
## 11      11 2016-01-07 pear              2           2
## 12      11 2016-01-10 apple             2           2
## 13      11 2016-01-14 apple             1           2
## 14      11 2016-01-16 apple             1           2</code></pre>
</div>
<div id="aggregating-values-from-another-data.frame-in-grouped_df" class="section level3">
<h3>Aggregating values from another data.frame in <code>grouped_df</code></h3>
<p><a href="https://stackoverflow.com/questions/61024712/do-a-rolling-regression-only-on-specific-dates/61045233#61045233">SO Discussion</a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(runner)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">Date &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2014-01-01&quot;</span>), </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">            <span class="dt">to =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2019-12-31&quot;</span>), </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">            <span class="dt">by =</span> <span class="st">'day'</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">market_return &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">2191</span>))</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">AAPL &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">  <span class="dt">Company.name =</span> <span class="st">&quot;AAPL&quot;</span>, </a>
<a class="sourceLine" id="cb10-11" data-line-number="11">  <span class="dt">Date =</span>  Date,</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">  <span class="dt">market_return =</span> market_return</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">MSFT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">  <span class="dt">Company.name =</span> <span class="st">&quot;MSFT&quot;</span>, </a>
<a class="sourceLine" id="cb10-17" data-line-number="17">  <span class="dt">Date =</span> Date,</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">  <span class="dt">market_return =</span> market_return</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21">df &lt;-<span class="st"> </span><span class="kw">rbind</span>(AAPL, MSFT)</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">df<span class="op">$</span>stock_return &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">4382</span>))</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">df &lt;-<span class="st"> </span>df[<span class="kw">order</span>(df<span class="op">$</span>Date),]</a>
<a class="sourceLine" id="cb10-24" data-line-number="24"></a>
<a class="sourceLine" id="cb10-25" data-line-number="25">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">  <span class="dt">Company.name2 =</span> <span class="kw">c</span>(<span class="kw">replicate</span>(<span class="dv">450</span>, <span class="st">&quot;AAPL&quot;</span>), <span class="kw">replicate</span>(<span class="dv">450</span>, <span class="st">&quot;MSFT&quot;</span>)), </a>
<a class="sourceLine" id="cb10-27" data-line-number="27">  <span class="dt">Event_date =</span> <span class="kw">sample</span>(</a>
<a class="sourceLine" id="cb10-28" data-line-number="28">    <span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">'2015/01/01'</span>), </a>
<a class="sourceLine" id="cb10-29" data-line-number="29">        <span class="kw">as.Date</span>(<span class="st">'2019/12/31'</span>), </a>
<a class="sourceLine" id="cb10-30" data-line-number="30">        <span class="dt">by =</span> <span class="st">&quot;day&quot;</span>),</a>
<a class="sourceLine" id="cb10-31" data-line-number="31">    <span class="dt">size =</span>  <span class="dv">900</span>)</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">)</a>
<a class="sourceLine" id="cb10-33" data-line-number="33"></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"></a>
<a class="sourceLine" id="cb10-35" data-line-number="35">df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="st">  </span><span class="kw">group_by</span>(Company.name2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb10-38" data-line-number="38">    <span class="dt">intercept =</span> <span class="kw">runner</span>(</a>
<a class="sourceLine" id="cb10-39" data-line-number="39">      <span class="dt">x =</span> df[df<span class="op">$</span>Company.name <span class="op">==</span><span class="st">  </span>Company.name2[<span class="dv">1</span>], ], </a>
<a class="sourceLine" id="cb10-40" data-line-number="40">      <span class="dt">k =</span> <span class="st">&quot;180 days&quot;</span>, </a>
<a class="sourceLine" id="cb10-41" data-line-number="41">      <span class="dt">lag =</span> <span class="st">&quot;5 days&quot;</span>,</a>
<a class="sourceLine" id="cb10-42" data-line-number="42">      <span class="dt">idx =</span> df<span class="op">$</span>Date[df<span class="op">$</span>Company.name <span class="op">==</span><span class="st"> </span>Company.name2[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb10-43" data-line-number="43">      <span class="dt">at =</span> Event_date,</a>
<a class="sourceLine" id="cb10-44" data-line-number="44">      <span class="dt">f =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb10-45" data-line-number="45">        <span class="kw">coef</span>(</a>
<a class="sourceLine" id="cb10-46" data-line-number="46">          <span class="kw">lm</span>(stock_return <span class="op">~</span><span class="st"> </span>market_return, <span class="dt">data =</span> x)</a>
<a class="sourceLine" id="cb10-47" data-line-number="47">        )[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb10-48" data-line-number="48">      }</a>
<a class="sourceLine" id="cb10-49" data-line-number="49">    ),</a>
<a class="sourceLine" id="cb10-50" data-line-number="50">    <span class="dt">slope =</span> <span class="kw">runner</span>(</a>
<a class="sourceLine" id="cb10-51" data-line-number="51">      <span class="dt">x =</span> df[df<span class="op">$</span>Company.name <span class="op">==</span><span class="st"> </span>Company.name2[<span class="dv">1</span>], ],  </a>
<a class="sourceLine" id="cb10-52" data-line-number="52">      <span class="dt">k =</span> <span class="st">&quot;180 days&quot;</span>, </a>
<a class="sourceLine" id="cb10-53" data-line-number="53">      <span class="dt">lag =</span> <span class="st">&quot;5 days&quot;</span>,</a>
<a class="sourceLine" id="cb10-54" data-line-number="54">      <span class="dt">idx =</span> df<span class="op">$</span>Date[df<span class="op">$</span>Company.name <span class="op">==</span><span class="st"> </span>Company.name2[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb10-55" data-line-number="55">      <span class="dt">at =</span> Event_date,</a>
<a class="sourceLine" id="cb10-56" data-line-number="56">      <span class="dt">f =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb10-57" data-line-number="57">        <span class="kw">coef</span>(</a>
<a class="sourceLine" id="cb10-58" data-line-number="58">          <span class="kw">lm</span>(stock_return <span class="op">~</span><span class="st"> </span>market_return, <span class="dt">data =</span> x)</a>
<a class="sourceLine" id="cb10-59" data-line-number="59">        )[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb10-60" data-line-number="60">      }</a>
<a class="sourceLine" id="cb10-61" data-line-number="61">    )</a>
<a class="sourceLine" id="cb10-62" data-line-number="62">  )</a></code></pre></div>
<pre><code>## # A tibble: 900 x 4
## # Groups:   Company.name2 [2]
##    Company.name2 Event_date intercept    slope
##    &lt;fct&gt;         &lt;date&gt;         &lt;dbl&gt;    &lt;dbl&gt;
##  1 AAPL          2017-10-29  -0.0291   0.0669 
##  2 AAPL          2019-04-08  -0.0701   0.0157 
##  3 AAPL          2017-08-05   0.0688  -0.00656
##  4 AAPL          2018-07-24   0.00725 -0.0304 
##  5 AAPL          2015-01-15   0.00982 -0.0998 
##  6 AAPL          2017-07-25   0.0686  -0.00609
##  7 AAPL          2015-11-23  -0.0482  -0.0269 
##  8 AAPL          2019-09-18  -0.0658   0.146  
##  9 AAPL          2016-07-04   0.00890 -0.00803
## 10 AAPL          2017-07-15   0.0691   0.00376
## #  with 890 more rows</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
